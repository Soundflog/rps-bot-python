@startuml
title Схема: deep_seq_analysis

' Начальные установки:
' ПХС = история соперника
' n = длина ПХС
' МДП = мин(5, n-1)
' L = МДП

:Нач. установк;
:Уст. n=Длина ПХС;
if ("n<2?") then (Да)
  :Вернуть None;
  stop
endif

:Уст. МДП=мин(5,n);
:Уст. L=МДП;

repeat
  :Уст. паттерн=ПХС[-L:];
  :Уст. СЧ={К:0,Б:0,Н:0};
  :Уст. ФЛАГ=ЛОЖЬ;
  :Уст. i=0;

  while ("i<n-L?") is (Да)
    if ("ПХС[i:i+L]=паттерн?") then (Да)
      :ФЛАГ=ИСТИНА;
      if ("i+L<n?") then (Да)
        :Ув. СЧ[ПХС[i+L]];
      endif
    endif
    :Ув. i на 1;
  endwhile

  if ("ФЛАГ?") then (Да)
    if ("СЧ>0?") then (Да)
      :Опред. Макс СЧ;
      :Вернуть предсказ;
      stop
    endif
  endif

  :Ум. L на 1;
repeat while ("L>0?") is (Да)

:Вернуть None;
stop
@enduml
