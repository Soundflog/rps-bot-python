# Продвинутая логика бота для игры "Камень-Ножницы-Бумага"

Данный бот использует многоуровневую стратегию для выбора ходов, опираясь на анализ поведения противника. Стратегия включает применение Марковских цепей, обнаружение паттернов в истории ходов и комбинированный режим для повышения точности предсказаний.

## Основные компоненты стратегии

### Overall Prediction
- **Описание:** Анализирует всю историю ходов противника.
- **Механизм:** Вычисляет частотное распределение для каждого из возможных ходов (Камень, Бумага, Ножницы).
- **Действие:** При отсутствии данных или при равенстве частот по умолчанию выбирает **Камень**.

### Markov Prediction
- **Описание:** Использует последний ход противника для анализа переходов между состояниями.
- **Механизм:** Опирается на матрицу переходов, которая фиксирует, какой ход чаще всего следует за данным.
- **Действие:** Если данных недостаточно, переходит к Overall Prediction.

### Pattern Detection
- **Описание:** Анализирует историю ходов противника для выявления повторяющихся последовательностей.
- **Механизм:** Последовательно рассматривает различные длины паттернов (от максимальной до минимальной) и ищет, какой ход обычно следует после найденного паттерна.
- **Действие:** При отсутствии подходящего паттерна использует алгоритм Overall Prediction.

### Counter Move
- **Описание:** Определяет ход, побеждающий предсказанный ход противника.
- **Механизм:** Если предсказанный ход — это:
  - **Камень** – выбирается **Бумага**
  - **Бумага** – выбираются **Ножницы**
  - **Ножницы** – выбирается **Камень**
- **Действие:** При неопределенности по умолчанию выбирается **Камень**.

### Основной алгоритм выбора хода (`choose`)
- **Обновление статистики:** При каждом вызове функция сохраняет последний ход противника, обновляя историю и матрицу переходов.
- **Переключение стратегий:** На основе счётчика ходов бот циклически применяет:
  - **Markov Prediction** (если номер хода по модулю 3 равен 0),
  - **Pattern Detection** (если номер хода по модулю 3 равен 1),
  - **Комбинированный режим** (если номер хода по модулю 3 равен 2), где сравниваются результаты Markov и Pattern Detection, а в случае расхождения используется Overall Prediction.
- **Определение контр-хода:** Полученное предсказание анализируется функцией Counter Move для выбора оптимального ответа.

## Интерфейс бота

Бот реализует стандартный интерфейс для участия в турнирах:

- **`set_parameters(set_count: int, wins_per_set: int)`**  
  Инициализирует параметры турнира и сбрасывает глобальное состояние, необходимое для анализа ходов.

- **`on_game_start()`**  
  Подготавливает бота к началу новой игры, очищая историю предыдущих ходов и переходов.

- **`choose(previous_opponent_choice: int) -> int`**  
  Основная функция, возвращающая следующий ход (число от 1 до 3, где 1 — Камень, 2 — Бумага, 3 — Ножницы).  
  При первом вызове, когда информации о предыдущем ходе нет, используется базовое значение.

- **`on_game_end()`**  
  Завершающие действия по окончании игры, например, логирование статистики.

## Пример работы стратегии

1. **Начало игры:**  
   - При первом вызове функции `choose` отсутствует история, поэтому бот действует по базовому алгоритму (чаще всего возвращает предопределённое значение).

2. **Накопление данных:**  
   - После каждого раунда бот обновляет историю ходов противника и матрицу переходов, что позволяет ему анализировать последовательности действий.

3. **Выбор стратегии:**  
   - На основе счётчика ходов бот циклически выбирает один из трёх режимов предсказания:
     - **Markov Prediction** анализирует переходы между ходами.
     - **Pattern Detection** ищет повторяющиеся последовательности.
     - **Комбинированный режим** сопоставляет результаты обоих методов и выбирает общее предсказание.
   
4. **Определение контр-хода:**  
   - Получив предсказание о том, какой ход, вероятнее всего, выберет противник, бот применяет алгоритм Counter Move для выбора хода, который его побеждает.

## Заключение

Данная реализация демонстрирует применение различных алгоритмических подходов для адаптивного и гибкого выбора ходов в игре "Камень-Ножницы-Бумага". Модульность кода позволяет легко модифицировать или расширять стратегию, экспериментируя с новыми методами анализа поведения противника.

---

# 1. Словесное описание стратегии

Продвинутый бот анализирует историю ходов противника и использует три метода предсказания следующего хода:

1. **Марковский анализ**  
   - Бот ведёт учет переходов от одного хода к другому.
   - На основе последнего хода противника выбирается ход, который чаще всего следовал за ним.

2. **Поиск паттернов**  
   - Бот ищет повторяющиеся последовательности в истории ходов.
   - Если найден паттерн, выбирается ход, который чаще всего следовал за ним.

3. **Общий анализ**  
   - Бот рассчитывает частотное распределение всех ходов противника.
   - При недостатке данных используется этот метод как резерв.

Выбор метода зависит от номера текущего хода (счетчика):
- Если **номер хода mod 3 = 0** – применяется **Марковский анализ**.
- Если **номер хода mod 3 = 1** – используется **Поиск паттернов**.
- Если **номер хода mod 3 = 2** – применяется **Комбинированный режим**:
  - Сравниваются результаты Марковского анализа и Поиска паттернов.
  - Если результаты совпадают, выбирается полученное значение.
  - Если различаются, используется общий анализ.

После предсказания бот определяет **контрход** – ход, побеждающий предсказанный:
- Если предсказан **«Камень»**, выбирается **«Бумага»**.
- Если предсказана **«Бумага»**, выбираются **«Ножницы»**.
- Если предсказаны **«Ножницы»**, выбирается **«Камень»**.

Выбранный ход сохраняется для использования в следующем раунде.

---

## Блок-схема

### Общая структура
![image](https://github.com/user-attachments/assets/cfaa9e0f-9205-4a4f-ad44-f0614f16b634)

### Диаграмма алгоритма choose
![image](https://github.com/user-attachments/assets/77550452-be5d-46a4-adc8-34c34bf8c629)

#### Диаграмма алгоритма Markov prediction
![image](https://github.com/user-attachments/assets/0d3a134b-c472-4ae4-9003-81e954492d18)

##### Диаграмма алгоритма Overall prediction
![image](https://github.com/user-attachments/assets/141b3fba-c577-4067-8fb6-44191e365910)

#### Диаграмма алгоритма Pattern prediction
![image](https://github.com/user-attachments/assets/51db9685-9904-4b5a-a4e7-45221244f777)

#### Диаграмма алгоритма Counter move
![image](https://github.com/user-attachments/assets/ca6447d4-0365-4135-896f-6a5db7a4a421)
