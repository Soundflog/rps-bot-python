@startuml
' Диаграмма алгоритма pattern_detection
title Pattern Detection Algorithm

start
:Оценить длину истории;
if (Истории недостаточно?) then (да)
  :Вызвать Overall Prediction;
  stop
endif
:Для каждого возможного размера паттерна (от максимального к минимальному):
  :Выбрать последние N ходов как паттерн;
  :Поиск предыдущего появления этого паттерна в истории;
  if (Паттерн найден и существует ход после него?) then (да)
    :Подсчитать, какой ход чаще всего следовал за паттерном;
    :При равенстве выбрать ROCK по умолчанию;
    :Вернуть выбранный ход;
    stop
  endif
:Если ни один паттерн не выявлен,
  :Вызвать Overall Prediction;
stop
@enduml